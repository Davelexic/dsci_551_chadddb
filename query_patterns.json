[
    {
        "pipeline": [
            {"$match": {"{field1}": {"$gte": "{value1}"}}},
            {"$group": {"_id": "${field2}", "total": {"$sum": 1}}},
            {"$sort": {"total": -1}},
            {"$limit": 0}
        ]
    },
    {
        "pipeline": [
            {"$group": {"_id": null, "average": {"$avg": "${field3}"}}}
        ]
    }
]